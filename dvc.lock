schema: '2.0'
stages:
  prepare_data:
    cmd: python src/stage_01_prepare_data.py --config=configs/config.yaml --params=params.yaml
    deps:
    - path: configs/config.yaml
      md5: 9a04455027a3609794de37640b030e1d
      size: 487
    - path: data/CTBM.raw.xlsx
      md5: 6b40fbe4df623abda8d0046ab31d95c5
      size: 818003
    - path: src/stage_01_prepare_data.py
      md5: 58938c6477eeb58e0f1711de5cd29687
      size: 2014
    - path: src/utils/common.py
      md5: d162961d817182441383bdb0e674e685
      size: 675
    - path: src/utils/data_process.py
      md5: 6fa50f3d97dc7ca1dc9e6f86bd03308a
      size: 1382
    params:
      params.yaml:
        prepare.seed: 2021
    outs:
    - path: artifacts/prepared/train.txt
      md5: f81bd60685db13e1a630caf438c766b1
      size: 323393
  featurize_data:
    cmd: python src/stage_02_featurization.py --config=configs/config.yaml --params=params.yaml
    deps:
    - path: artifacts/prepared/train.txt
      md5: f81bd60685db13e1a630caf438c766b1
      size: 323393
    - path: configs/config.yaml
      md5: 9a04455027a3609794de37640b030e1d
      size: 487
    - path: src/stage_02_featurization.py
      md5: 79625b4a5c8f753b3dd6d43baa575c5a
      size: 4017
    - path: src/utils/common.py
      md5: d162961d817182441383bdb0e674e685
      size: 675
    - path: src/utils/data_process.py
      md5: 6fa50f3d97dc7ca1dc9e6f86bd03308a
      size: 1382
    params:
      params.yaml:
        featurize.batch_size: 64
        featurize.buffer_size: 10000
        featurize.seq_length: 100
    outs:
    - path: artifacts/features/dataset.tfrecord
      md5: 5892807b811b5ba1ba4bf6c4d4c014f3.dir
      size: 2563279
      nfiles: 3
    - path: artifacts/features/text_as_integer.pkl
      md5: 5a121aa7f3c6b8bc37d9a62e67f8d2d5
      size: 1293829
    - path: artifacts/features/vocab_data.pkl
      md5: 06961b55fd40d8c5eddb9afc24ae46ec
      size: 304
  train:
    cmd: python src/stage_03_train.py --config=configs/config.yaml --params=params.yaml
    deps:
    - path: artifacts/features/dataset.tfrecord
      md5: 5892807b811b5ba1ba4bf6c4d4c014f3.dir
      size: 2563279
      nfiles: 3
    - path: artifacts/features/text_as_integer.pkl
      md5: 5a121aa7f3c6b8bc37d9a62e67f8d2d5
      size: 1293829
    - path: artifacts/features/vocab_data.pkl
      md5: 06961b55fd40d8c5eddb9afc24ae46ec
      size: 304
    - path: configs/config.yaml
      md5: 9a04455027a3609794de37640b030e1d
      size: 487
    - path: src/stage_03_train.py
      md5: 9c320a3b3a039da5c1053e47c3577b35
      size: 3441
    - path: src/utils/common.py
      md5: d162961d817182441383bdb0e674e685
      size: 675
    - path: src/utils/models.py
      md5: 625a0cf05dfac1d6c2db93c53e449f67
      size: 1696
    params:
      params.yaml:
        featurize.batch_size: 64
        train.embedding_dim: 256
        train.epochs: 3
        train.optimizer: adam
        train.rnn_units: 1024
        train.verbose: 2
    outs:
    - path: artifacts/model
      md5: ce658ad8f7e2a1c907c4c5413343a3f7.dir
      size: 143500263
      nfiles: 7
  evaluate:
    cmd: python src/stage_04_evaluate.py --config=configs/config.yaml --params=params.yaml
    deps:
    - path: artifacts/features/text_as_integer.pkl
      md5: 5a121aa7f3c6b8bc37d9a62e67f8d2d5
      size: 1293829
    - path: artifacts/features/vocab_data.pkl
      md5: 06961b55fd40d8c5eddb9afc24ae46ec
      size: 304
    - path: artifacts/model
      md5: ce658ad8f7e2a1c907c4c5413343a3f7.dir
      size: 143500263
      nfiles: 7
    - path: configs/config.yaml
      md5: 9a04455027a3609794de37640b030e1d
      size: 487
    - path: src/stage_04_evaluate.py
      md5: fd27a1a1a01565418cb3aa602314858b
      size: 2987
    - path: src/utils/common.py
      md5: d162961d817182441383bdb0e674e685
      size: 675
    - path: src/utils/models.py
      md5: 625a0cf05dfac1d6c2db93c53e449f67
      size: 1696
    params:
      params.yaml:
        evaluate.no_of_chars_to_gen: 1000
        evaluate.start_string: shoe
        train.embedding_dim: 256
        train.rnn_units: 1024
